sudo: false
dist: focal
os: linux

arch:
  - amd64
  - arm64
  - ppc64le
  - s390x

language: go
go:
  - "1.15"

# Only clone the most recent commit.
git:
  depth: 1

before_install:
  # Dump environment variables
  - printenv

install:
  - "go get -u -v github.com/kevinburke/go-bindata/..."

before_script:
  - "make magneticod"
  - "make magneticow"
  - "make image"

matrix:
  include:
    - script: make check-formatting
    - script: make vet
    - script: make test
    - script: make magneticod
    - script: make magneticow
    # - script: make image